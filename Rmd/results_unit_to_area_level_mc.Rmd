# From Unit to Area Level Contamination

In this section a different perspective is taken in that a model\hyp{}based
simulation study is conducted beginning from a unit level population. This is an
approach taken typical for unit level models; see for example @Cha14 and @Sin09.
However results for robust area level models are often produced using area level
data -- see for example @Fab10 -- or studied using survey data -- see for 
example @Bel06 and @Xie07. This area level perspective implicitly rules out any
impact of unit level outliers on area level models; and whether such
observations can influence predictions is subject of this Section.

This change in perspective enables a more thorough investigation of the impact
of unit level contamination when applying area level models. Furthermore it must
be stated how we estimate the sampling variance of the direct estimator which
can have an impact as well; these quantities have been assumed to be known so
far. In the literature the estimation of the sampling variances is often 
connected to the application of smoothing techniques -- see Section (?) for a 
review -- to stabilise these parameters. Hence in this context several points
motivate this study:

- Under the FH model we specify an area level model with a heteroscedastic
sampling distribution. The model does not explain the source for this
heteroscedasticity. In the following two different sources are induced: one is
the sample size varying across domains, and the other one are unit level
outliers.
- When we begin from the unit level we may ask what the true sampling variance 
is; this quantity is assumed to be known under the model. In practice these
values are estimated and are themselves unreliable if the target is the
population variance. So it will be relevant to discuss how the FH estimator and
the robust extension perform when the direct variance estimator is an additional
source of uncertainty. Also it is unclear how smoothing techniques relate to
unit level outliers.
- In the context of unit level outliers it can be intuitive to suggest a robust 
direct estimator instead of the sample mean. Hence different robust direct
estimators are used as an alternative to the domain specific sample mean.

This discussion is of practical relevance but is conceptually unrelated to
the question if we exploit spatial and temporal correlation structures in the 
data. For this reason the following study has a focus on the FH model and 
excludes the spatial and temporal extensions. In principle these results should 
apply to these extensions also; however this remains an avenue for further
research.

This simulation study is structured as follows: the following Section 
\ref{sec:results_unit_level_model} completes the formal link between the unit 
and area level. Essentially we need to specify assumptions with respect to the 
unit level population model to have a coherent link between the population 
level, the sampled level, and the area level. Based on these results Section
\ref{sec:results_unit_sim_setting} presents the simulation settings; Section
\ref{sec:results_unit_measures} the investigated estimation strategies; and in
Section \ref{sec:results_unit_results} the results of the Monte Carlo Simulation
are presented.


## A Unit Level Population Model
\label{sec:results_unit_level_model}

In the following the unit level population model assumed for this study is 
presented. In contrast to the BHF model reviewed in Section (?) here we do not
need the distinction between sampled and non\hyp{}sampled units. Hence we begin
with a liner mixed model for the population of the form:
$$
y_{ij} = x_i^\top \beta + \re_i + e_{ij}
$$
with $i = 1, \dots, D$ and $j = 1, \dots, N_i$. Here $x_i$ is a vector of 
auxiliary information and $\beta$ the vector of regression coefficients; $\re_i$
is a i.i.d. random variable: $\re_i \sim \Distr{N}(0, \sigre)$; and 
$e_{ij}$ is also a i.i.d. random variable: $e_{ij} \sim \Distr{N}(0, 
\sigma_e^2)$. Given this simple unit level model consider the case in which we
draw samples with simple random sampling without replacement (SRSWOR) in each
domain. Here we only consider the case where units are observed for all domains.
The domain specific sample sizes are denoted by $n_i$. When we use the sample
mean as a direct estimator we can derive the area level model as:
$$
\bar{y}_i = \underbrace{x_i^\top \beta + \re_i}_{\theta_i} + \bar{e}_i
$$
with $i = 1, \dots, D$. Here $\bar{y}_i$ denotes the direct estimator and
$\theta_i$ the true target statistic. The sampling errors, $\bar{e}_i$, are
i.i.d. with $\bar{e}_i \sim \Distr{N}(0, \sige)$ where $\sige =
\frac{\sigma_e^2}{n_i}$. In this simple setting $x_i$ and $\re_i$ are the same
for the unit and area level since they are constant within domains. Also we see
in the definition of $\sige$ that the only source for the heteroscedasticity are
the sample sizes, $n_i$. An additional source for heteroscedastic sample errors may also be induced by unit level outliers. 

## Simulation Scenarios
\label{sec:results_unit_sim_setting}

In general our simulation setup borrows from unit level scenarios from the literature to make this exercise as convenient as possible. The basis is again a linear mixed model, this time defined on the unit population level:

  $$\sij{y} = 100 + 1 \cdot \si{x} + v_i + \sij{e}$$

- The regressor, $x_i$, and random effect, $v_i$, are defined in the same way as
for the area level scenario.
- The error term, $\sij{e}$, is defined as $\sij{e} \sim \Distr{N}(0, 
\sigma_e^2)$ where $\sigma_e^2$ is varies across simulation scenarios.
- From this populatin model we draw samples with simple random sampling without
replacement. The sample sizes are $n_i \in \{5, \dots, 15\}$ and $N_i = 1000$;
$D$ is again 100.
- The sample is then aggregated using different direct estimators. The sample
mean, the sample median and a robust direct estimator (huber m-type). Note that
$x_i$ is constant within domains. For the variance estimation we use the sample
variance, a generalized variance function which can be considered optimal under
the population model and the median absolute deviance from the median within
domains.
- On area level the standard Fay Herriot model is used with different variance
estimators and corresponding direct estimators and compared with the RFH.

With these settings we are interested in several different choices varying
across simulation scenarios. We want to emphasise how unit and area level
outliers can influence area level predictions.

1. *(0, 0)* This is the scenario in which the area level model as described in 
section? holds, i.e. there are no outliers. Here $\sigma_e^2 = 4^2$ and $\sigre =
1$ for all domains. However, the sampling variances ($\sige =
\frac{\sigma_e^2}{n_i}$) derived under the unit level population model range
from 1 to 3.2 for their respective sample size. $\sigre = 1$.
2. *(v, 0)* This scenario is close to the area level data generation in the 
previous section where we induced area level outliers. For that purpose we 
choose $\sigre = 1$ for the areas where $i \in \{1, \dots, 95\}$ and $\sigre = 
20^2$ for $i \in \{96, \dots, 100\}$
3. *(0, e)* In this scenario unit level outliers do exist. To make the magnitude
comparable to simulation studies in the literature we choose $\sigma_e^2 = 
150^2$ for $i \in \{90, \dots, 95\}$.
4. *(v, e)* This scenario is the combination of 2 and 3 where we have area level
and unit level outliers, however not in the same domains.

## Quality Measures and Considered Methods
\label{sec:results_unit_measures}

## Results
\label{sec:results_unit_results}

![\textrrmse](figs/unit_to_area_level_mc_rrmse_all.pdf)

![\textrbias](figs/unit_to_area_level_mc_rbias_all.pdf)


## Discussion

