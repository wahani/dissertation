# From Unit to Area Level Contamination

In this section a different perspective is taken in that a model\hyp{}based
simulation study is conducted beginning from a unit level population. This is an
approach taken typical for unit level models; see for example @Cha14 and @Sin09.
However results for robust area level models are often produced using area level
data -- see for example @Fab10 -- or studied using survey data -- see for 
example @Bel06 and @Xie07. This area level perspective implicitly rules out any
impact of unit level outliers on area level models; and whether such
observations can influence predictions is subject of this Section.

This change in perspective enables a more thorough investigation of the impact
of unit level contamination when applying area level models. Furthermore it must
be stated how we estimate the sampling variance of the direct estimator which
can have an impact as well; these quantities have been assumed to be known so
far. In the literature the estimation of the sampling variances is often 
connected to the application of smoothing techniques -- see Section (?) for a 
review -- to stabilise these parameters. Hence in this context several points
motivate this study:

- Under the FH model we specify an area level model with a heteroscedastic
sampling distribution. The model does not explain the source for this
heteroscedasticity. In the following two different sources are induced: one is
the sample size varying across domains, and the other one are unit level
outliers.
- When we begin from the unit level we may ask what the true sampling variance 
is; this quantity is assumed to be known under the model. In practice these
values are estimated and are themselves unreliable if the target is the
population variance. So it will be relevant to discuss how the FH estimator and
the robust extension perform when the direct variance estimator is an additional
source of uncertainty. Also it is unclear how smoothing techniques relate to
unit level outliers.
- In the context of unit level outliers it can be intuitive to suggest a robust 
direct estimator instead of the sample mean. Hence different robust direct
estimators are used as an alternative to the domain specific sample mean.

This discussion is of practical relevance but is conceptually unrelated to
the question if we exploit spatial and temporal correlation structures in the 
data. For this reason the following study has a focus on the FH model and 
excludes the spatial and temporal extensions. In principle these results should 
apply to these extensions also; however this remains an avenue for further
research.

This simulation study is structured as follows: the following Section 
\ref{sec:results_unit_level_model} completes the formal link between the unit 
and area level. Essentially we need to specify assumptions with respect to the 
unit level population model to have a coherent link between the population 
level, the sampled level, and the area level. Based on these results Section
\ref{sec:results_unit_sim_setting} presents the simulation settings; Section
\ref{sec:results_unit_measures} the investigated estimation strategies; and in
Section \ref{sec:results_unit_results} the results of the Monte Carlo Simulation
are presented.


## A Unit Level Population Model
\label{sec:results_unit_level_model}

In the following the unit level population model assumed for this study is 
presented. In contrast to the BHF model reviewed in Section (?) here we do not
need the distinction between sampled and non\hyp{}sampled units. Hence we begin
with a liner mixed model for the population of the form:
$$
y_{ij} = x_i^\top \beta + \re_i + e_{ij}
$$
with $i = 1, \dots, D$ and $j = 1, \dots, N_i$. Here $x_i$ is a vector of 
auxiliary information and $\beta$ the vector of regression coefficients; $\re_i$
is a i.i.d. random variable: $\re_i \sim \Distr{N}(0, \sigre)$; and 
$e_{ij}$ is also a i.i.d. random variable: $e_{ij} \sim \Distr{N}(0, 
\sigma_e^2)$. Given this simple unit level model consider the case in which we
draw samples with simple random sampling without replacement (SRSWOR) in each
domain. Here we only consider the case where units are observed for all domains.
The domain specific sample sizes are denoted by $n_i$. When we use the sample
mean as a direct estimator we can derive the area level model as:
$$
\bar{y}_i = \underbrace{x_i^\top \beta + \re_i}_{\theta_i} + \bar{e}_i
$$
with $i = 1, \dots, D$. Here $\bar{y}_i$ denotes the direct estimator and
$\theta_i$ the true target statistic. The sampling errors, $\bar{e}_i$, are
i.i.d. with $\bar{e}_i \sim \Distr{N}(0, \sige)$ where $\sige =
\frac{\sigma_e^2}{n_i}$. In this simple setting $x_i$ and $\re_i$ are the same
for the unit and area level since they are constant within domains. Also we see
in the definition of $\sige$ that the only source for the heteroscedasticity are
the sample sizes, $n_i$. An additional source for heteroscedastic sample errors may also be induced by unit level outliers. 

## Simulation Scenarios
\label{sec:results_unit_sim_setting}

The model underlying the Monte Carlo study is given by:
$$y_{ij} = 100 + 5 x_i + \re_i + e_{ij}$$

- The regressor, $x_i$, is a deterministic sequence defined as in the 
model\hyp{}based scenarios before: $x_i = \frac{i}{2D} + 1$
- From this model a population is generated in each Monte Carlo repetition. Each
domain is of size $N_i = 1000$ and we consider $D = 40$ as before.
- Samples are drawn with SRSWOR in each domain. The sample sizes are defined as 
$n_i \in \{5, \dots, 15\}$. They are sorted as ascending sequence in $i$. The 
sample sizes are chosen in corespondence to the variance of the unit error in
the non\hyp{}outlier scenario such that the sampling variances of the sample
means are an ascending sequence between 2 and 6.

With these settings several different choices for outlier contamination are
investigated. Here we can now consider unit and area level outliers:

- *(0, 0)* -- no contamination. Here $\re_i \sim \Distr{N}(0, 4)$ and
$e_{ij} \sim \Distr{N}(0, 32)$.
- *(u, 0)* -- area level outliers. Similar to the generation before the 
non\hyp{}contaminated domains are generated from $\re_i \sim \Distr{N}(0, 4)$
and $e_{ij} \sim \Distr{N}(0, 32)$. Outlying domains are domains with $i \in
\{5, 15, 25, 35\}$ and their respective random effect is given by $\re_i \sim
\Distr{N}(9, 25)$.
- *(0, e)* -- unit level outliers. The random effect is drawn from $\re_i \sim 
\Distr{N}(0, 4)$. Individual outliers are generated from a mixtrue of two 
normals: $e_{ij} \sim \delta \Distr{N}(0, 32) + (1 - \delta) \Distr{N}(20, 200)$
where $\delta$ is a Bernoulli random variable with $\Exp{P}(\delta = 1) = 0.9$.
I.e. 10 per cent of the unit level observations are from the outlier
distribution.
- *(u, e)* -- unit and area level outliers. The area level contamination is
imposed as in *(u, 0)* and the unit level contamination as in *(0, e)*.


## Quality Measures and Considered Methods
\label{sec:results_unit_measures}

## Results
\label{sec:results_unit_results}

![\textrrmse](figs/unit_to_area_level_mc_rrmse_all.pdf)

![\textrbias](figs/unit_to_area_level_mc_rbias_all.pdf)


## Discussion

